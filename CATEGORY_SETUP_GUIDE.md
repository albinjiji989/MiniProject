# üè∑Ô∏è E-Commerce Category Hierarchy Setup

## Category Structure Overview

The e-commerce module supports **unlimited category levels** with a professional hierarchy system:

```
Level 0 (Main Categories)
‚îú‚îÄ Level 1 (Subcategories)
‚îÇ  ‚îú‚îÄ Level 2 (Sub-subcategories)
‚îÇ  ‚îÇ  ‚îî‚îÄ Products
```

---

## üìã Real-World Category Examples

### 1. **Food Category**

```
Food (Level 0)
‚îú‚îÄ Dog Food (Level 1)
‚îÇ  ‚îú‚îÄ Pedigree (Level 2)
‚îÇ  ‚îú‚îÄ Royal Canin (Level 2)
‚îÇ  ‚îú‚îÄ Drools (Level 2)
‚îÇ  ‚îî‚îÄ Purina (Level 2)
‚îú‚îÄ Cat Food (Level 1)
‚îÇ  ‚îú‚îÄ Whiskas (Level 2)
‚îÇ  ‚îú‚îÄ Royal Canin (Level 2)
‚îÇ  ‚îî‚îÄ Me-O (Level 2)
‚îú‚îÄ Bird Food (Level 1)
‚îÇ  ‚îú‚îÄ Seeds Mix (Level 2)
‚îÇ  ‚îú‚îÄ Pellets (Level 2)
‚îÇ  ‚îî‚îÄ Treats (Level 2)
‚îî‚îÄ Fish Food (Level 1)
   ‚îú‚îÄ Flakes (Level 2)
   ‚îú‚îÄ Pellets (Level 2)
   ‚îî‚îÄ Frozen Food (Level 2)
```

### 2. **Toys Category**

```
Toys (Level 0)
‚îú‚îÄ Dog Toys (Level 1)
‚îÇ  ‚îú‚îÄ Balls (Level 2)
‚îÇ  ‚îú‚îÄ Chew Toys (Level 2)
‚îÇ  ‚îú‚îÄ Rope Toys (Level 2)
‚îÇ  ‚îú‚îÄ Squeaky Toys (Level 2)
‚îÇ  ‚îî‚îÄ Interactive Toys (Level 2)
‚îú‚îÄ Cat Toys (Level 1)
‚îÇ  ‚îú‚îÄ Feather Wands (Level 2)
‚îÇ  ‚îú‚îÄ Laser Pointers (Level 2)
‚îÇ  ‚îú‚îÄ Catnip Toys (Level 2)
‚îÇ  ‚îî‚îÄ Mice Toys (Level 2)
‚îî‚îÄ Bird Toys (Level 1)
   ‚îú‚îÄ Swings (Level 2)
   ‚îú‚îÄ Bells (Level 2)
   ‚îî‚îÄ Mirrors (Level 2)
```

### 3. **Accessories Category**

```
Accessories (Level 0)
‚îú‚îÄ Collars & Leashes (Level 1)
‚îÇ  ‚îú‚îÄ Dog Collars (Level 2)
‚îÇ  ‚îú‚îÄ Cat Collars (Level 2)
‚îÇ  ‚îú‚îÄ Harnesses (Level 2)
‚îÇ  ‚îî‚îÄ Leashes (Level 2)
‚îú‚îÄ Bowls & Feeders (Level 1)
‚îÇ  ‚îú‚îÄ Food Bowls (Level 2)
‚îÇ  ‚îú‚îÄ Water Fountains (Level 2)
‚îÇ  ‚îî‚îÄ Automatic Feeders (Level 2)
‚îî‚îÄ Beds & Furniture (Level 1)
   ‚îú‚îÄ Dog Beds (Level 2)
   ‚îú‚îÄ Cat Trees (Level 2)
   ‚îî‚îÄ Pet Houses (Level 2)
```

### 4. **Grooming Category**

```
Grooming (Level 0)
‚îú‚îÄ Shampoos & Conditioners (Level 1)
‚îÇ  ‚îú‚îÄ Dog Shampoo (Level 2)
‚îÇ  ‚îú‚îÄ Cat Shampoo (Level 2)
‚îÇ  ‚îú‚îÄ Medicated Shampoo (Level 2)
‚îÇ  ‚îî‚îÄ Dry Shampoo (Level 2)
‚îú‚îÄ Brushes & Combs (Level 1)
‚îÇ  ‚îú‚îÄ Slicker Brushes (Level 2)
‚îÇ  ‚îú‚îÄ De-shedding Tools (Level 2)
‚îÇ  ‚îî‚îÄ Nail Clippers (Level 2)
‚îî‚îÄ Dental Care (Level 1)
   ‚îú‚îÄ Toothbrush (Level 2)
   ‚îú‚îÄ Toothpaste (Level 2)
   ‚îî‚îÄ Dental Chews (Level 2)
```

### 5. **Healthcare Category**

```
Healthcare (Level 0)
‚îú‚îÄ Supplements (Level 1)
‚îÇ  ‚îú‚îÄ Multivitamins (Level 2)
‚îÇ  ‚îú‚îÄ Joint Support (Level 2)
‚îÇ  ‚îú‚îÄ Skin & Coat (Level 2)
‚îÇ  ‚îî‚îÄ Digestive Health (Level 2)
‚îú‚îÄ Medicines (Level 1)
‚îÇ  ‚îú‚îÄ Dewormers (Level 2)
‚îÇ  ‚îú‚îÄ Flea & Tick (Level 2)
‚îÇ  ‚îî‚îÄ Antibiotics (Level 2)
‚îî‚îÄ First Aid (Level 1)
   ‚îú‚îÄ Bandages (Level 2)
   ‚îú‚îÄ Antiseptics (Level 2)
   ‚îî‚îÄ First Aid Kits (Level 2)
```

---

## üöÄ Setting Up Categories (Manager)

### Step 1: Create Level 0 (Main Category)

**POST** `/api/ecommerce/manager/categories`

```json
{
  "name": "Food",
  "slug": "food",
  "description": "Pet food for all types of pets",
  "parent": null,
  "image": "https://example.com/food-category.jpg",
  "icon": "üçñ",
  "displayOrder": 1,
  "metaTitle": "Pet Food - Best Quality Pet Food Online",
  "metaDescription": "Shop premium pet food for dogs, cats, birds, and fish",
  "metaKeywords": "pet food, dog food, cat food, bird food",
  "isActive": true
}
```

### Step 2: Create Level 1 (Subcategory)

**POST** `/api/ecommerce/manager/categories`

```json
{
  "name": "Dog Food",
  "slug": "dog-food",
  "description": "Nutritious food for dogs of all ages",
  "parent": "FOOD_CATEGORY_ID",  // ‚Üê Reference to parent
  "image": "https://example.com/dog-food.jpg",
  "displayOrder": 1,
  "metaTitle": "Dog Food - Premium Dog Food Online",
  "metaDescription": "Buy the best dog food brands",
  "isActive": true
}
```

### Step 3: Create Level 2 (Brand/Sub-subcategory)

**POST** `/api/ecommerce/manager/categories`

```json
{
  "name": "Pedigree",
  "slug": "pedigree",
  "description": "Pedigree dog food products",
  "parent": "DOG_FOOD_CATEGORY_ID",  // ‚Üê Reference to parent
  "image": "https://example.com/pedigree.jpg",
  "displayOrder": 1,
  "metaTitle": "Pedigree Dog Food - Buy Online",
  "metaDescription": "Premium Pedigree dog food at best prices",
  "isActive": true
}
```

### Step 4: Add Product to Category

**POST** `/api/ecommerce/manager/products`

```json
{
  "name": "Pedigree Adult Dry Dog Food, Chicken & Vegetables, 10kg",
  "category": "DOG_FOOD_CATEGORY_ID",      // Level 1
  "subcategory": "PEDIGREE_CATEGORY_ID",   // Level 2
  "basePrice": 1499,
  "salePrice": 1299,
  "stock": 100,
  "petType": "dog",
  "ageGroup": "adult",
  "brand": "Pedigree",
  "weight": "10kg",
  "description": "Complete nutrition for adult dogs...",
  "images": [
    {
      "url": "https://example.com/pedigree-10kg.jpg",
      "alt": "Pedigree Dog Food 10kg",
      "isPrimary": true,
      "order": 1
    }
  ],
  "status": "active"
}
```

---

## üåê User Experience - Category Browsing

### Homepage Category Display

Users see main categories (Level 0):

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Browse by Category                              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  üçñ Food    üéæ Toys    üéÄ Accessories          ‚îÇ
‚îÇ  üíÖ Grooming    üè• Healthcare    üõèÔ∏è Furniture    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Category Page (Level 0 ‚Üí Level 1)

Click "Food" ‚Üí Show subcategories:

```
Food
‚îú‚îÄ üêï Dog Food
‚îú‚îÄ üê± Cat Food
‚îú‚îÄ ü¶ú Bird Food
‚îî‚îÄ üê† Fish Food
```

### Subcategory Page (Level 1 ‚Üí Level 2)

Click "Dog Food" ‚Üí Show brands:

```
Dog Food
‚îú‚îÄ Pedigree (234 products)
‚îú‚îÄ Royal Canin (189 products)
‚îú‚îÄ Drools (156 products)
‚îî‚îÄ Purina (98 products)
```

### Brand Page (Level 2 ‚Üí Products)

Click "Pedigree" ‚Üí Show products:

```
Pedigree Dog Food
‚îú‚îÄ Pedigree Adult Dry Dog Food 10kg
‚îú‚îÄ Pedigree Puppy Dry Dog Food 3kg
‚îú‚îÄ Pedigree Senior Dog Food 1kg
‚îî‚îÄ ... (234 products)
```

---

## üìä Manager Dashboard - Category Tree View

**GET** `/api/ecommerce/manager/categories/tree`

Returns hierarchical structure:

```json
[
  {
    "_id": "food_id",
    "name": "Food",
    "level": 0,
    "productCount": 1234,
    "children": [
      {
        "_id": "dog_food_id",
        "name": "Dog Food",
        "level": 1,
        "productCount": 567,
        "children": [
          {
            "_id": "pedigree_id",
            "name": "Pedigree",
            "level": 2,
            "productCount": 234,
            "children": []
          },
          {
            "_id": "royal_canin_id",
            "name": "Royal Canin",
            "level": 2,
            "productCount": 189,
            "children": []
          }
        ]
      },
      {
        "_id": "cat_food_id",
        "name": "Cat Food",
        "level": 1,
        "productCount": 423,
        "children": [...]
      }
    ]
  }
]
```

---

## üéØ Breadcrumb Navigation (User View)

When viewing product:

```
Home > Food > Dog Food > Pedigree > Pedigree Adult 10kg
```

**GET** `/api/ecommerce/categories/:categoryId`

Returns with breadcrumb:

```json
{
  "success": true,
  "data": {
    "_id": "pedigree_id",
    "name": "Pedigree",
    "level": 2,
    "breadcrumb": [
      { "name": "Food", "slug": "food", "level": 0 },
      { "name": "Dog Food", "slug": "dog-food", "level": 1 },
      { "name": "Pedigree", "slug": "pedigree", "level": 2 }
    ]
  }
}
```

---

## üîß Category Management Operations

### 1. View All Categories

**GET** `/api/ecommerce/manager/categories`

Query params:
- `level=0` - Get only main categories
- `level=1` - Get only subcategories
- `parent=categoryId` - Get children of specific category
- `search=dog` - Search categories by name

### 2. Get Category Statistics

**GET** `/api/ecommerce/manager/categories/:categoryId/stats`

```json
{
  "success": true,
  "data": {
    "category": "Dog Food",
    "level": 1,
    "directProducts": 567,
    "totalProducts": 567,      // Including all subcategories
    "subcategories": 4,
    "allDescendants": 4
  }
}
```

### 3. Reorder Categories

**POST** `/api/ecommerce/manager/categories/reorder`

```json
{
  "categories": [
    { "id": "food_id", "displayOrder": 1 },
    { "id": "toys_id", "displayOrder": 2 },
    { "id": "accessories_id", "displayOrder": 3 }
  ]
}
```

### 4. Toggle Category Active Status

**PATCH** `/api/ecommerce/manager/categories/:categoryId/toggle-active`

Activates/deactivates category (products won't show if inactive)

### 5. Delete Category

**DELETE** `/api/ecommerce/manager/categories/:categoryId`

‚ö†Ô∏è **Rules:**
- Cannot delete if has products
- Cannot delete if has subcategories
- Must move/delete all children first

---

## üé® Frontend Category Selector (Manager)

When creating product, show cascading dropdowns:

```jsx
<FormGroup>
  <Label>Main Category *</Label>
  <Select
    options={level0Categories}
    onChange={(cat) => {
      setSelectedCategory(cat);
      loadSubcategories(cat.value);
    }}
  />
</FormGroup>

<FormGroup>
  <Label>Subcategory *</Label>
  <Select
    options={level1Categories}
    onChange={(cat) => {
      setSelectedSubcategory(cat);
      loadBrands(cat.value);
    }}
    disabled={!selectedCategory}
  />
</FormGroup>

<FormGroup>
  <Label>Brand/Type</Label>
  <Select
    options={level2Categories}
    onChange={(cat) => setSelectedBrand(cat)}
    disabled={!selectedSubcategory}
  />
</FormGroup>
```

---

## üì± User Mobile App Category Navigation

**Level 0 - Main Menu:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üçñ Food            ‚îÇ
‚îÇ üéæ Toys            ‚îÇ
‚îÇ üéÄ Accessories     ‚îÇ
‚îÇ üíÖ Grooming        ‚îÇ
‚îÇ üè• Healthcare      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Level 1 - Subcategories:**
```
‚Üê Food
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üêï Dog Food        ‚îÇ
‚îÇ üê± Cat Food        ‚îÇ
‚îÇ ü¶ú Bird Food       ‚îÇ
‚îÇ üê† Fish Food       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Level 2 - Brands:**
```
‚Üê Dog Food
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Pedigree           ‚îÇ
‚îÇ Royal Canin        ‚îÇ
‚îÇ Drools             ‚îÇ
‚îÇ Purina             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîÑ Complete Setup Script

```javascript
// Run this after server starts to create initial categories

const setupCategories = async () => {
  // Level 0: Food
  const food = await createCategory({
    name: "Food",
    slug: "food",
    description: "Pet food for all pets",
    parent: null
  });

  // Level 1: Dog Food
  const dogFood = await createCategory({
    name: "Dog Food",
    slug: "dog-food",
    parent: food._id
  });

  // Level 2: Brands
  await createCategory({
    name: "Pedigree",
    slug: "pedigree",
    parent: dogFood._id
  });

  await createCategory({
    name: "Royal Canin",
    slug: "royal-canin",
    parent: dogFood._id
  });

  // Repeat for other categories...
};
```

---

## ‚úÖ Key Features

1. **Unlimited Levels** - Support for 3+ levels if needed
2. **Auto Level Calculation** - Level auto-set based on parent
3. **Breadcrumb Support** - Full navigation path
4. **Product Count Tracking** - Real-time product counts
5. **SEO Optimized** - Meta tags for each category
6. **Display Ordering** - Custom sort order
7. **Cascading Status** - Inactive parent hides children
8. **Safe Deletion** - Prevents deletion if has products/children

---

**Manager adds products. Users browse seamlessly. Admin monitors everything!** üöÄ
